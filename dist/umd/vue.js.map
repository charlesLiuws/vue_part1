{"version":3,"file":"vue.js","sources":["../../src/util/index.js","../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["//一些公共方法\r\nexport function isObject(data){\r\n    return typeof data === 'object' && data !== null\r\n}","//拷贝数组的原型方法\r\nlet oldArrayProtoMethods = Array.prototype;\r\n//创建一个空对象，将其继承数组的原型对象\r\nlet arrayMethods = Object.create(Array.prototype);\r\n//改造可改变原数组的七种原型方法\r\nlet methods=['push','sort','splice','reverse','pop','shift','unshift'];\r\nmethods.forEach(method=>{\r\n    arrayMethods[method]=function (...args){\r\n        //新增的逻辑\r\n        console.log('Array is change !');\r\n        let inserted;\r\n        switch (method) {\r\n            case 'push':\r\n            case 'unshift':\r\n                inserted=args;\r\n                break;\r\n            case 'splice':\r\n                inserted=args.slice(2)\r\n            default:\r\n                break;\r\n        }\r\n        if(inserted){\r\n            //对数组里新增的对象进行监听\r\n            this.__ob__.observeArray(inserted);\r\n        }\r\n        //执行原有的数组方法\r\n        return oldArrayProtoMethods[method].call(this,...args);\r\n    }\r\n})\r\nexport {arrayMethods}","import {isObject} from '../util/index'\r\nimport {arrayMethods} from './array'\r\n//把data中的数据都使用object.defineProperty重新定义 属于es5方法(不兼容ie8以及一下版本)\r\nexport function observe(data){\r\n    // console.log(data,'observe');\r\n    let isObj=isObject(data);   //是否为对象\r\n    if(!isObj){\r\n        return;\r\n    }\r\n    return new Observer(data)\r\n}\r\nclass Observer{\r\n    constructor(value){\r\n        Object.defineProperty(value,'__ob__',{\r\n            value:this,\r\n            enumerable:false\r\n        })\r\n        if(Array.isArray(value)){\r\n            value.__proto__=arrayMethods;\r\n            // 劫持原有数组里的对象\r\n            this.observeArray(value);\r\n        }else{\r\n            this.walk(value);\r\n        }\r\n    }\r\n    observeArray(value){\r\n        value.forEach(item=>{\r\n            observe(item);\r\n        })\r\n    }\r\n    walk(data){\r\n        Object.keys(data).forEach(key=>{\r\n            defineReactive(data,key,data[key]);\r\n        })\r\n    }\r\n}\r\nfunction defineReactive(data,key,value){\r\n    observe(value); //递归实现深度劫持\r\n    Object.defineProperty(data,key,{\r\n        get(){\r\n            return value;\r\n        },\r\n        set(newValue){\r\n            if(newValue === value){\r\n                return;\r\n            }\r\n            observe(newValue); //继续劫持用户设置的新值（设置对象）\r\n            value=newValue;\r\n        }\r\n    })\r\n}","import {observe} from './observer/index'\r\nexport function initState(Vm){\r\n    const opts=Vm.$options;\r\n    //vue的数据来源：属性 方法 数据 计算属性 watch\r\n    if(opts.props){\r\n        initProps(Vm);\r\n    }\r\n    if(opts.methods){\r\n        initMethods(Vm);\r\n    }\r\n    if(opts.data){\r\n        initData(Vm);\r\n    }\r\n    if(opts.computed){\r\n        initComputed(Vm);\r\n    }\r\n    if(opts.watch){\r\n        initWatch(Vm);\r\n    }\r\n}\r\nfunction initProps(Vm){}\r\nfunction initMethods(Vm){}\r\nfunction proxy(vm,source,key){\r\n    Object.defineProperty(vm,key,{\r\n        get(){\r\n            return vm[source][key]\r\n        },\r\n        set(newValue){\r\n            vm[source][key]=newValue;\r\n        }\r\n    })\r\n}\r\nfunction initData(Vm){\r\n    //数据初始化\r\n    let data=Vm.$options.data;\r\n    data=Vm._data=typeof data === 'function'?data.call(Vm):data;\r\n    Object.keys(data).forEach(key=>{\r\n        proxy(Vm,'_data',key)\r\n    })\r\n    // Object.defineProperty() 给属性增加get方法和set方法\r\n    observe(data); //响应式原理\r\n\r\n}\r\nfunction initComputed(Vm){}\r\nfunction initWatch(Vm){}","import {initState} from './state'\r\n// 在原型上添加一个init方法\r\nexport function initMixin(Vue){\r\n    // 初始化流程\r\n    Vue.prototype._init=function(options){\r\n        // console.log(options);\r\n        // 数据劫持\r\n        const Vm=this;\r\n        Vm.$options=options;\r\n        //初始化状态\r\n        initState(Vm);\r\n    }\r\n}","import {initMixin} from './init'\r\n\r\n// vue核心代码 相当于vue的声明\r\nfunction Vue(options){\r\n    // Vue初始化操作\r\n    this._init(options)\r\n\r\n}\r\n\r\n//通过引入文件方式给vue添加原型方法\r\ninitMixin(Vue);\r\n\r\nexport default Vue;"],"names":["isObject","data","oldArrayProtoMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","console","log","inserted","args","slice","__ob__","observeArray","call","observe","isObj","Observer","value","defineProperty","enumerable","isArray","__proto__","walk","item","keys","key","defineReactive","get","set","newValue","initState","Vm","opts","$options","props","initData","computed","watch","proxy","vm","source","_data","initMixin","Vue","_init","options"],"mappings":"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"}